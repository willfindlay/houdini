name: write-etc-passwd-vm
environment:
  kernelTag: "5.13.19"
  kconfig: "~/Desktop/buildroot-bpfcontain/test/linux-5.13.19-config/.config"
  buildroot: "~/Desktop/buildroot-bpfcontain/test/buildroot-config/.config"
steps:
  - host:
      script:
      - command: cp
        args: ["/etc/passwd", "/tmp/passwd"]
      failure: setupFailure
  - spawnContainer:
      name: infinite-bash
      image: bash
      cmd: sleep infinity
      volumes:
      - "/tmp/passwd:/passwd"
      failure: setupFailure
  - container:
      name: infinite-bash
      script:
      - command: bash
        args: ["-c", "echo foo > /passwd"]
      failure: exploitFailure
      success: exploitSuccess
